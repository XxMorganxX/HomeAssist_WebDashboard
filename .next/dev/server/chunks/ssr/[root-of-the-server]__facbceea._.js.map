{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/morgannstuart/Desktop/HomeAssist-WEB/HomeAssist-Dashboard/src/components/Sidebar.tsx"],"sourcesContent":["import { MessageSquare, Terminal, Settings, Zap, BarChart3 } from 'lucide-react'\n\ninterface SidebarProps {\n  activeView: string\n  onViewChange: (view: string) => void\n  isConfigured?: boolean\n}\n\nexport function Sidebar({ activeView, onViewChange, isConfigured = false }: SidebarProps) {\n  return (\n    <aside className=\"sidebar\">\n      <div className=\"sidebar-header\">\n        <div className=\"logo\">\n          <Zap className=\"logo-icon\" />\n          <span>Dashboard</span>\n        </div>\n      </div>\n\n      <nav className=\"sidebar-nav\">\n        <div className=\"nav-section\">\n          <span className=\"nav-section-title\">Views</span>\n          <button\n            className={`nav-item ${activeView === 'conversations' ? 'active' : ''}`}\n            onClick={() => onViewChange('conversations')}\n          >\n            <MessageSquare size={18} />\n            <span>Conversations</span>\n          </button>\n          <button\n            className={`nav-item ${activeView === 'console' ? 'active' : ''}`}\n            onClick={() => onViewChange('console')}\n          >\n            <Terminal size={18} />\n            <span>Console</span>\n          </button>\n          <button\n            className={`nav-item ${activeView === 'usage' ? 'active' : ''}`}\n            onClick={() => onViewChange('usage')}\n          >\n            <BarChart3 size={18} />\n            <span>Usage</span>\n          </button>\n          <button\n            className={`nav-item ${activeView === 'settings' ? 'active' : ''}`}\n            onClick={() => onViewChange('settings')}\n          >\n            <Settings size={18} />\n            <span>Settings</span>\n          </button>\n        </div>\n      </nav>\n\n      <div className=\"sidebar-footer\">\n        <div className={`connection-status ${isConfigured ? 'connected' : ''}`}>\n          <span className=\"status-dot\" />\n          <span>{isConfigured ? 'Connected' : 'Not Connected'}</span>\n        </div>\n      </div>\n    </aside>\n  )\n}\n"],"names":[],"mappings":";;;;;AAAA;AAAA;AAAA;AAAA;AAAA;;;AAQO,SAAS,QAAQ,EAAE,UAAU,EAAE,YAAY,EAAE,eAAe,KAAK,EAAgB;IACtF,qBACE,8OAAC;QAAM,WAAU;;0BACf,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC,uMAAG;4BAAC,WAAU;;;;;;sCACf,8OAAC;sCAAK;;;;;;;;;;;;;;;;;0BAIV,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAK,WAAU;sCAAoB;;;;;;sCACpC,8OAAC;4BACC,WAAW,CAAC,SAAS,EAAE,eAAe,kBAAkB,WAAW,IAAI;4BACvE,SAAS,IAAM,aAAa;;8CAE5B,8OAAC,yOAAa;oCAAC,MAAM;;;;;;8CACrB,8OAAC;8CAAK;;;;;;;;;;;;sCAER,8OAAC;4BACC,WAAW,CAAC,SAAS,EAAE,eAAe,YAAY,WAAW,IAAI;4BACjE,SAAS,IAAM,aAAa;;8CAE5B,8OAAC,sNAAQ;oCAAC,MAAM;;;;;;8CAChB,8OAAC;8CAAK;;;;;;;;;;;;sCAER,8OAAC;4BACC,WAAW,CAAC,SAAS,EAAE,eAAe,UAAU,WAAW,IAAI;4BAC/D,SAAS,IAAM,aAAa;;8CAE5B,8OAAC,+NAAS;oCAAC,MAAM;;;;;;8CACjB,8OAAC;8CAAK;;;;;;;;;;;;sCAER,8OAAC;4BACC,WAAW,CAAC,SAAS,EAAE,eAAe,aAAa,WAAW,IAAI;4BAClE,SAAS,IAAM,aAAa;;8CAE5B,8OAAC,sNAAQ;oCAAC,MAAM;;;;;;8CAChB,8OAAC;8CAAK;;;;;;;;;;;;;;;;;;;;;;;0BAKZ,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAW,CAAC,kBAAkB,EAAE,eAAe,cAAc,IAAI;;sCACpE,8OAAC;4BAAK,WAAU;;;;;;sCAChB,8OAAC;sCAAM,eAAe,cAAc;;;;;;;;;;;;;;;;;;;;;;;AAK9C"}},
    {"offset": {"line": 217, "column": 0}, "map": {"version":3,"sources":["file:///Users/morgannstuart/Desktop/HomeAssist-WEB/HomeAssist-Dashboard/src/lib/supabase.ts"],"sourcesContent":["import { createClient, SupabaseClient } from '@supabase/supabase-js'\n\n// Check localStorage first, then fall back to env variables\nconst getSupabaseUrl = (): string => {\n  if (typeof window !== 'undefined') {\n    const stored = localStorage.getItem('supabase_url')\n    if (stored) return stored\n  }\n  return process.env.NEXT_PUBLIC_SUPABASE_URL || ''\n}\n\nconst getSupabaseAnonKey = (): string => {\n  if (typeof window !== 'undefined') {\n    const stored = localStorage.getItem('supabase_anon_key')\n    if (stored) return stored\n  }\n  return process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || ''\n}\n\nlet supabaseInstance: SupabaseClient | null = null\n\nexport const getSupabase = (): SupabaseClient => {\n  const url = getSupabaseUrl()\n  const key = getSupabaseAnonKey()\n  \n  if (!supabaseInstance && url && key) {\n    supabaseInstance = createClient(url, key)\n  }\n  \n  return supabaseInstance || createClient('https://placeholder.supabase.co', 'placeholder')\n}\n\nexport const reinitializeSupabase = (): SupabaseClient => {\n  const url = getSupabaseUrl()\n  const key = getSupabaseAnonKey()\n  \n  if (url && key) {\n    supabaseInstance = createClient(url, key)\n  }\n  \n  return supabaseInstance || createClient('https://placeholder.supabase.co', 'placeholder')\n}\n\nexport const isConfigured = (): boolean => {\n  const url = getSupabaseUrl()\n  const key = getSupabaseAnonKey()\n  return Boolean(url && key && url !== '' && key !== '')\n}\n\n// Create a Supabase client from provided credentials (for API routes)\nexport const createSupabaseFromCredentials = (url: string, key: string): SupabaseClient => {\n  return createClient(url, key)\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAEA,4DAA4D;AAC5D,MAAM,iBAAiB;IACrB;;IAIA,OAAO,QAAQ,GAAG,CAAC,wBAAwB,IAAI;AACjD;AAEA,MAAM,qBAAqB;IACzB;;IAIA,OAAO,QAAQ,GAAG,CAAC,6BAA6B,IAAI;AACtD;AAEA,IAAI,mBAA0C;AAEvC,MAAM,cAAc;IACzB,MAAM,MAAM;IACZ,MAAM,MAAM;IAEZ,IAAI,CAAC,oBAAoB,OAAO,KAAK;QACnC,mBAAmB,IAAA,uLAAY,EAAC,KAAK;IACvC;IAEA,OAAO,oBAAoB,IAAA,uLAAY,EAAC,mCAAmC;AAC7E;AAEO,MAAM,uBAAuB;IAClC,MAAM,MAAM;IACZ,MAAM,MAAM;IAEZ,IAAI,OAAO,KAAK;QACd,mBAAmB,IAAA,uLAAY,EAAC,KAAK;IACvC;IAEA,OAAO,oBAAoB,IAAA,uLAAY,EAAC,mCAAmC;AAC7E;AAEO,MAAM,eAAe;IAC1B,MAAM,MAAM;IACZ,MAAM,MAAM;IACZ,OAAO,QAAQ,OAAO,OAAO,QAAQ,MAAM,QAAQ;AACrD;AAGO,MAAM,gCAAgC,CAAC,KAAa;IACzD,OAAO,IAAA,uLAAY,EAAC,KAAK;AAC3B"}},
    {"offset": {"line": 269, "column": 0}, "map": {"version":3,"sources":["file:///Users/morgannstuart/Desktop/HomeAssist-WEB/HomeAssist-Dashboard/src/components/ConversationViewer.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { getSupabase, isConfigured } from '@/lib/supabase'\nimport { \n  MessageSquare, \n  User, \n  Bot, \n  Wrench, \n  ChevronRight,\n  RefreshCw,\n  Search,\n  Clock,\n  ChevronDown,\n  ChevronUp,\n  Settings2,\n  Mic\n} from 'lucide-react'\nimport type { ConversationSession, ConversationMessage, ToolCall } from '@/types/database'\n\ninterface MessageWithTools extends ConversationMessage {\n  tool_calls: ToolCall[]\n}\n\nexport function ConversationViewer() {\n  const [sessions, setSessions] = useState<ConversationSession[]>([])\n  const [selectedSession, setSelectedSession] = useState<string | null>(null)\n  const [messages, setMessages] = useState<MessageWithTools[]>([])\n  const [loading, setLoading] = useState(true)\n  const [messagesLoading, setMessagesLoading] = useState(false)\n  const [searchTerm, setSearchTerm] = useState('')\n  const [expandedTools, setExpandedTools] = useState<Set<number>>(new Set())\n  const [error, setError] = useState<string | null>(null)\n\n  useEffect(() => {\n    if (isConfigured()) {\n      fetchSessions()\n    } else {\n      setLoading(false)\n      setError('Supabase not configured. Please add your credentials in Settings.')\n    }\n  }, [])\n\n  useEffect(() => {\n    if (selectedSession) {\n      fetchMessages(selectedSession)\n    }\n  }, [selectedSession])\n\n  const fetchSessions = async () => {\n    setLoading(true)\n    setError(null)\n    \n    try {\n      const supabase = getSupabase()\n      const { data, error: fetchError } = await supabase\n        .from('conversation_sessions')\n        .select('*')\n        .order('started_at', { ascending: false })\n        .limit(100)\n\n      if (fetchError) {\n        console.error('Fetch error:', fetchError)\n        const errorMsg = fetchError.message || fetchError.code || JSON.stringify(fetchError)\n        setError(errorMsg || 'Failed to fetch sessions')\n        return\n      }\n      \n      setSessions(data || [])\n      \n      if (data && data.length > 0 && !selectedSession) {\n        setSelectedSession(data[0].id)\n      }\n    } catch (err) {\n      console.error('Failed to fetch sessions:', err)\n      setError(err instanceof Error ? err.message : 'Failed to fetch sessions')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const fetchMessages = async (sessionId: string) => {\n    setMessagesLoading(true)\n    try {\n      const supabase = getSupabase()\n      \n      const { data: messagesData, error: messagesError } = await supabase\n        .from('conversation_messages')\n        .select('*')\n        .eq('session_id', sessionId)\n        .order('timestamp', { ascending: true })\n\n      if (messagesError) throw messagesError\n\n      if (!messagesData || messagesData.length === 0) {\n        setMessages([])\n        return\n      }\n\n      const assistantMessageIds = messagesData\n        .filter(m => m.role === 'assistant')\n        .map(m => m.id)\n\n      let toolCallsMap: Record<number, ToolCall[]> = {}\n\n      if (assistantMessageIds.length > 0) {\n        const { data: toolCallsData, error: toolCallsError } = await supabase\n          .from('tool_calls')\n          .select('*')\n          .in('message_id', assistantMessageIds)\n          .order('executed_at', { ascending: true })\n\n        if (toolCallsError) {\n          console.error('Failed to fetch tool calls:', toolCallsError)\n        } else if (toolCallsData) {\n          toolCallsMap = toolCallsData.reduce((acc, tc) => {\n            if (!acc[tc.message_id]) acc[tc.message_id] = []\n            acc[tc.message_id].push(tc)\n            return acc\n          }, {} as Record<number, ToolCall[]>)\n        }\n      }\n\n      const messagesWithTools: MessageWithTools[] = messagesData.map(msg => ({\n        ...msg,\n        tool_calls: toolCallsMap[msg.id] || []\n      }))\n\n      setMessages(messagesWithTools)\n    } catch (err) {\n      console.error('Failed to fetch messages:', err)\n    } finally {\n      setMessagesLoading(false)\n    }\n  }\n\n  const handleRefresh = () => {\n    fetchSessions()\n  }\n\n  const toggleToolExpanded = (toolId: number) => {\n    setExpandedTools(prev => {\n      const next = new Set(prev)\n      if (next.has(toolId)) {\n        next.delete(toolId)\n      } else {\n        next.add(toolId)\n      }\n      return next\n    })\n  }\n\n  const filteredSessions = sessions.filter(session => {\n    const searchLower = searchTerm.toLowerCase()\n    return (\n      session.id.toLowerCase().includes(searchLower) ||\n      session.user_id?.toLowerCase().includes(searchLower) ||\n      session.wake_word_model?.toLowerCase().includes(searchLower)\n    )\n  })\n\n  const formatDate = (dateStr: string) => {\n    const date = new Date(dateStr)\n    const now = new Date()\n    const diffMs = now.getTime() - date.getTime()\n    const diffMins = Math.floor(diffMs / 60000)\n    const diffHours = Math.floor(diffMs / 3600000)\n    const diffDays = Math.floor(diffMs / 86400000)\n\n    if (diffMins < 1) return 'Just now'\n    if (diffMins < 60) return `${diffMins}m ago`\n    if (diffHours < 24) return `${diffHours}h ago`\n    if (diffDays < 7) return `${diffDays}d ago`\n    return date.toLocaleDateString()\n  }\n\n  const formatDuration = (session: ConversationSession) => {\n    if (!session.ended_at) return 'Active'\n    const start = new Date(session.started_at).getTime()\n    const end = new Date(session.ended_at).getTime()\n    const durationMs = end - start\n    const seconds = Math.floor(durationMs / 1000)\n    const minutes = Math.floor(seconds / 60)\n    if (minutes > 0) return `${minutes}m ${seconds % 60}s`\n    return `${seconds}s`\n  }\n\n  const renderToolCall = (toolCall: ToolCall) => {\n    const isExpanded = expandedTools.has(toolCall.id)\n\n    return (\n      <div key={toolCall.id} className=\"tool-call\">\n        <button \n          className=\"tool-call-header\"\n          onClick={() => toggleToolExpanded(toolCall.id)}\n        >\n          <div className=\"tool-call-info\">\n            <Wrench size={14} />\n            <span className=\"tool-name\">{toolCall.tool_name}</span>\n            {toolCall.duration_ms && (\n              <span className=\"tool-duration\">{toolCall.duration_ms.toFixed(0)}ms</span>\n            )}\n          </div>\n          {isExpanded ? <ChevronUp size={14} /> : <ChevronDown size={14} />}\n        </button>\n        \n        {isExpanded && (\n          <div className=\"tool-call-details\">\n            <div className=\"tool-section\">\n              <span className=\"tool-section-label\">Arguments</span>\n              <pre className=\"tool-code\">\n                {JSON.stringify(toolCall.arguments, null, 2)}\n              </pre>\n            </div>\n            {toolCall.result && (\n              <div className=\"tool-section\">\n                <span className=\"tool-section-label\">Result</span>\n                <pre className=\"tool-code\">{toolCall.result}</pre>\n              </div>\n            )}\n            <div className=\"tool-meta\">\n              <span>Executed: {new Date(toolCall.executed_at).toLocaleTimeString()}</span>\n            </div>\n          </div>\n        )}\n      </div>\n    )\n  }\n\n  const renderMessage = (message: MessageWithTools) => {\n    const isUser = message.role === 'user'\n    const isAssistant = message.role === 'assistant'\n    const isSystem = message.role === 'system'\n\n    return (\n      <div key={message.id} className={`message ${message.role}`}>\n        <div className=\"message-avatar\">\n          {isUser && <User size={18} />}\n          {isAssistant && <Bot size={18} />}\n          {isSystem && <Settings2 size={18} />}\n        </div>\n        \n        <div className=\"message-body\">\n          <div className=\"message-header\">\n            <span className=\"message-role\">\n              {isUser && 'User'}\n              {isAssistant && 'Assistant'}\n              {isSystem && 'System'}\n            </span>\n            <span className=\"message-time\">\n              {new Date(message.timestamp).toLocaleTimeString()}\n            </span>\n            {message.confidence !== null && (\n              <span className=\"message-confidence\">\n                {(message.confidence * 100).toFixed(0)}% confidence\n              </span>\n            )}\n            {!message.is_final && (\n              <span className=\"message-interim\">interim</span>\n            )}\n          </div>\n          \n          <div className=\"message-content\">\n            {message.content}\n          </div>\n          \n          {message.tool_calls && message.tool_calls.length > 0 && (\n            <div className=\"tool-calls\">\n              <div className=\"tool-calls-header\">\n                <Wrench size={14} />\n                <span>{message.tool_calls.length} tool call{message.tool_calls.length > 1 ? 's' : ''}</span>\n              </div>\n              {message.tool_calls.map(tc => renderToolCall(tc))}\n            </div>\n          )}\n        </div>\n      </div>\n    )\n  }\n\n  const getSessionPreview = (session: ConversationSession) => {\n    if (selectedSession === session.id && messages.length > 0) {\n      const firstUserMsg = messages.find(m => m.role === 'user')\n      if (firstUserMsg) {\n        return firstUserMsg.content.slice(0, 50) + (firstUserMsg.content.length > 50 ? '...' : '')\n      }\n    }\n    return null\n  }\n\n  if (error) {\n    return (\n      <div className=\"conversation-viewer\">\n        <div className=\"error-state\">\n          <div className=\"error-icon\">⚠️</div>\n          <h2>Connection Error</h2>\n          <p>{error}</p>\n          <button className=\"retry-btn\" onClick={handleRefresh}>\n            <RefreshCw size={16} />\n            Retry\n          </button>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"conversation-viewer\">\n      <div className=\"conversations-sidebar\">\n        <div className=\"conversations-header\">\n          <h3>\n            <MessageSquare size={18} />\n            Sessions\n          </h3>\n          <button className=\"icon-btn\" onClick={handleRefresh} title=\"Refresh\">\n            <RefreshCw size={16} className={loading ? 'spinning' : ''} />\n          </button>\n        </div>\n        \n        <div className=\"conversations-search\">\n          <Search size={14} />\n          <input\n            type=\"text\"\n            placeholder=\"Search sessions...\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n          />\n        </div>\n\n        <div className=\"conversations-list\">\n          {loading ? (\n            <div className=\"loading-state small\">\n              <div className=\"spinner\" />\n            </div>\n          ) : filteredSessions.length === 0 ? (\n            <div className=\"empty-conversations\">\n              <MessageSquare size={24} />\n              <span>No sessions found</span>\n            </div>\n          ) : (\n            filteredSessions.map((session) => (\n              <button\n                key={session.id}\n                className={`conversation-item ${selectedSession === session.id ? 'active' : ''}`}\n                onClick={() => setSelectedSession(session.id)}\n              >\n                <div className=\"conversation-info\">\n                  <span className=\"conversation-title\">\n                    {session.wake_word_model ? (\n                      <><Mic size={12} /> {session.wake_word_model}</>\n                    ) : (\n                      `Session ${session.id.slice(0, 8)}...`\n                    )}\n                  </span>\n                  <span className=\"conversation-preview\">\n                    {getSessionPreview(session) || `User: ${session.user_id}`}\n                  </span>\n                  <div className=\"session-meta-row\">\n                    <span className={`session-status ${session.ended_at ? 'ended' : 'active'}`}>\n                      {session.ended_at ? 'Ended' : 'Active'}\n                    </span>\n                    <span className=\"session-duration\">{formatDuration(session)}</span>\n                  </div>\n                </div>\n                <div className=\"conversation-meta\">\n                  <Clock size={12} />\n                  <span>{formatDate(session.started_at)}</span>\n                </div>\n                <ChevronRight size={14} className=\"conversation-arrow\" />\n              </button>\n            ))\n          )}\n        </div>\n      </div>\n\n      <div className=\"messages-panel\">\n        {!selectedSession ? (\n          <div className=\"no-conversation\">\n            <MessageSquare size={48} />\n            <h2>Select a Session</h2>\n            <p>Choose a conversation session from the sidebar to view its messages</p>\n          </div>\n        ) : messagesLoading ? (\n          <div className=\"loading-state\">\n            <div className=\"spinner\" />\n            <span>Loading messages...</span>\n          </div>\n        ) : messages.length === 0 ? (\n          <div className=\"no-messages\">\n            <MessageSquare size={32} />\n            <p>No messages in this session</p>\n          </div>\n        ) : (\n          <div className=\"messages-container\">\n            <div className=\"messages-header\">\n              <div className=\"messages-header-info\">\n                <h2>\n                  {sessions.find(s => s.id === selectedSession)?.wake_word_model || \n                   `Session ${selectedSession.slice(0, 8)}...`}\n                </h2>\n                <span className=\"session-id\">{selectedSession}</span>\n              </div>\n              <div className=\"messages-header-meta\">\n                <span className=\"message-count\">{messages.length} messages</span>\n                <span className=\"tool-count\">\n                  {messages.reduce((acc, m) => acc + (m.tool_calls?.length || 0), 0)} tool calls\n                </span>\n              </div>\n            </div>\n            <div className=\"messages-list\">\n              {messages.map(renderMessage)}\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1178, "column": 0}, "map": {"version":3,"sources":["file:///Users/morgannstuart/Desktop/HomeAssist-WEB/HomeAssist-Dashboard/src/components/Console.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect, useRef } from 'react'\nimport { Terminal, Trash2, User, Bot, Zap, RefreshCw } from 'lucide-react'\nimport type { ConsoleLog } from '@/types/database'\n\nconst POLL_INTERVAL = 1000 // Poll every second\n\nexport function Console() {\n  const [logs, setLogs] = useState<ConsoleLog[]>([])\n  const [token, setToken] = useState<string | null>(null)\n  const [lastTimestamp, setLastTimestamp] = useState<string | null>(null)\n  const [isPolling, setIsPolling] = useState(false)\n  const messagesEndRef = useRef<HTMLDivElement>(null)\n  const pollIntervalRef = useRef<NodeJS.Timeout | null>(null)\n\n  useEffect(() => {\n    const savedToken = localStorage.getItem('console_token')\n    setToken(savedToken)\n  }, [])\n\n  useEffect(() => {\n    // Auto-scroll to bottom when new messages arrive\n    if (messagesEndRef.current) {\n      messagesEndRef.current.scrollIntoView({ behavior: 'smooth' })\n    }\n  }, [logs])\n\n  const fetchLogs = async () => {\n    if (!token) return\n\n    try {\n      const params = new URLSearchParams({ token })\n      if (lastTimestamp) {\n        params.append('since', lastTimestamp)\n      }\n\n      const res = await fetch(`/api/console/log?${params}`)\n      const data = await res.json()\n\n      if (data.success && data.logs.length > 0) {\n        setLogs(prev => {\n          // Merge new logs, avoiding duplicates\n          const existingIds = new Set(prev.map(l => l.id))\n          const newLogs = data.logs.filter((l: ConsoleLog) => !existingIds.has(l.id))\n          return [...prev, ...newLogs]\n        })\n        \n        // Update last timestamp\n        const latestLog = data.logs[data.logs.length - 1]\n        setLastTimestamp(latestLog.timestamp)\n      }\n    } catch (err) {\n      console.error('Failed to fetch logs:', err)\n    }\n  }\n\n  // Auto-start polling when token is available\n  useEffect(() => {\n    if (!token) return\n\n    setIsPolling(true)\n    fetchLogs() // Fetch immediately\n    \n    // Start polling\n    pollIntervalRef.current = setInterval(fetchLogs, POLL_INTERVAL)\n\n    return () => {\n      // Cleanup on unmount or token change\n      if (pollIntervalRef.current) {\n        clearInterval(pollIntervalRef.current)\n        pollIntervalRef.current = null\n      }\n      setIsPolling(false)\n    }\n  }, [token])\n\n  const clearLogs = async () => {\n    if (!token) return\n    \n    try {\n      await fetch(`/api/console/log?token=${token}`, { method: 'DELETE' })\n      setLogs([])\n      setLastTimestamp(null)\n    } catch (err) {\n      console.error('Failed to clear logs:', err)\n    }\n  }\n\n  const getMessageIcon = (type: string) => {\n    switch (type) {\n      case 'user':\n        return <User size={16} />\n      case 'agent':\n        return <Bot size={16} />\n      case 'command':\n      default:\n        return <Zap size={16} />\n    }\n  }\n\n  const getMessageLabel = (type: string) => {\n    switch (type) {\n      case 'user':\n        return 'User'\n      case 'agent':\n        return 'Agent'\n      case 'command':\n      default:\n        return 'System'\n    }\n  }\n\n  const formatTime = (timestamp: string) => {\n    return new Date(timestamp).toLocaleTimeString([], { \n      hour: '2-digit', \n      minute: '2-digit',\n      second: '2-digit'\n    })\n  }\n\n  // No token configured\n  if (!token) {\n    return (\n      <div className=\"console-container\">\n        <div className=\"console-empty\">\n          <Terminal size={48} />\n          <h2>No Console Token</h2>\n          <p>Go to Settings and set a Console Token to start receiving logs.</p>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"console-container\">\n      <div className=\"console-header\">\n        <div className=\"console-title\">\n          <Terminal size={20} />\n          <h2>Live Console</h2>\n          <span className=\"live-badge\">\n            <RefreshCw size={12} className={isPolling ? 'spinning' : ''} />\n            LIVE\n          </span>\n        </div>\n        <div className=\"console-meta\">\n          <span className=\"token-badge\">Token: {token.slice(0, 12)}...</span>\n        </div>\n        <div className=\"console-actions\">\n          <button\n            className=\"icon-btn\"\n            onClick={clearLogs}\n            disabled={logs.length === 0}\n            title=\"Clear console\"\n          >\n            <Trash2 size={16} />\n          </button>\n        </div>\n      </div>\n\n      <div className=\"console-body\">\n        {logs.length === 0 ? (\n          <div className=\"console-empty-logs\">\n            <Terminal size={32} className=\"pulse\" />\n            <p>Waiting for messages...</p>\n            <span>POST to /api/console/log with token: {token.slice(0, 8)}...</span>\n          </div>\n        ) : (\n          <div className=\"chat-messages\">\n            {logs.map((log) => {\n              const messageType = log.type || 'command'\n              return (\n                <div \n                  key={log.id} \n                  className={`chat-message ${messageType}`}\n                >\n                  <div className={`chat-avatar ${messageType}`}>\n                    {getMessageIcon(messageType)}\n                  </div>\n                  \n                  <div className=\"chat-content\">\n                    <div className=\"chat-header\">\n                      <span className={`chat-sender ${messageType}`}>\n                        {getMessageLabel(messageType)}\n                      </span>\n                      <span className=\"chat-time\">\n                        {formatTime(log.timestamp)}\n                      </span>\n                      {log.is_positive !== undefined && (\n                        <span className={`chat-status ${log.is_positive ? 'success' : 'error'}`}>\n                          {log.is_positive ? '✓' : '✗'}\n                        </span>\n                      )}\n                    </div>\n                    <div className=\"chat-text\">\n                      {log.text}\n                    </div>\n                  </div>\n                </div>\n              )\n            })}\n            <div ref={messagesEndRef} />\n          </div>\n        )}\n      </div>\n\n      <div className=\"console-footer\">\n        <span>{logs.length} message{logs.length !== 1 ? 's' : ''}</span>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAHA;;;;AAMA,MAAM,gBAAgB,KAAK,oBAAoB;;AAExC,SAAS;IACd,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAe,EAAE;IACjD,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAgB;IAClD,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,iNAAQ,EAAgB;IAClE,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAC3C,MAAM,iBAAiB,IAAA,+MAAM,EAAiB;IAC9C,MAAM,kBAAkB,IAAA,+MAAM,EAAwB;IAEtD,IAAA,kNAAS,EAAC;QACR,MAAM,aAAa,aAAa,OAAO,CAAC;QACxC,SAAS;IACX,GAAG,EAAE;IAEL,IAAA,kNAAS,EAAC;QACR,iDAAiD;QACjD,IAAI,eAAe,OAAO,EAAE;YAC1B,eAAe,OAAO,CAAC,cAAc,CAAC;gBAAE,UAAU;YAAS;QAC7D;IACF,GAAG;QAAC;KAAK;IAET,MAAM,YAAY;QAChB,IAAI,CAAC,OAAO;QAEZ,IAAI;YACF,MAAM,SAAS,IAAI,gBAAgB;gBAAE;YAAM;YAC3C,IAAI,eAAe;gBACjB,OAAO,MAAM,CAAC,SAAS;YACzB;YAEA,MAAM,MAAM,MAAM,MAAM,CAAC,iBAAiB,EAAE,QAAQ;YACpD,MAAM,OAAO,MAAM,IAAI,IAAI;YAE3B,IAAI,KAAK,OAAO,IAAI,KAAK,IAAI,CAAC,MAAM,GAAG,GAAG;gBACxC,QAAQ,CAAA;oBACN,sCAAsC;oBACtC,MAAM,cAAc,IAAI,IAAI,KAAK,GAAG,CAAC,CAAA,IAAK,EAAE,EAAE;oBAC9C,MAAM,UAAU,KAAK,IAAI,CAAC,MAAM,CAAC,CAAC,IAAkB,CAAC,YAAY,GAAG,CAAC,EAAE,EAAE;oBACzE,OAAO;2BAAI;2BAAS;qBAAQ;gBAC9B;gBAEA,wBAAwB;gBACxB,MAAM,YAAY,KAAK,IAAI,CAAC,KAAK,IAAI,CAAC,MAAM,GAAG,EAAE;gBACjD,iBAAiB,UAAU,SAAS;YACtC;QACF,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,yBAAyB;QACzC;IACF;IAEA,6CAA6C;IAC7C,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,OAAO;QAEZ,aAAa;QACb,aAAY,oBAAoB;QAEhC,gBAAgB;QAChB,gBAAgB,OAAO,GAAG,YAAY,WAAW;QAEjD,OAAO;YACL,qCAAqC;YACrC,IAAI,gBAAgB,OAAO,EAAE;gBAC3B,cAAc,gBAAgB,OAAO;gBACrC,gBAAgB,OAAO,GAAG;YAC5B;YACA,aAAa;QACf;IACF,GAAG;QAAC;KAAM;IAEV,MAAM,YAAY;QAChB,IAAI,CAAC,OAAO;QAEZ,IAAI;YACF,MAAM,MAAM,CAAC,uBAAuB,EAAE,OAAO,EAAE;gBAAE,QAAQ;YAAS;YAClE,QAAQ,EAAE;YACV,iBAAiB;QACnB,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,yBAAyB;QACzC;IACF;IAEA,MAAM,iBAAiB,CAAC;QACtB,OAAQ;YACN,KAAK;gBACH,qBAAO,8OAAC,0MAAI;oBAAC,MAAM;;;;;;YACrB,KAAK;gBACH,qBAAO,8OAAC,uMAAG;oBAAC,MAAM;;;;;;YACpB,KAAK;YACL;gBACE,qBAAO,8OAAC,uMAAG;oBAAC,MAAM;;;;;;QACtB;IACF;IAEA,MAAM,kBAAkB,CAAC;QACvB,OAAQ;YACN,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT,KAAK;YACL;gBACE,OAAO;QACX;IACF;IAEA,MAAM,aAAa,CAAC;QAClB,OAAO,IAAI,KAAK,WAAW,kBAAkB,CAAC,EAAE,EAAE;YAChD,MAAM;YACN,QAAQ;YACR,QAAQ;QACV;IACF;IAEA,sBAAsB;IACtB,IAAI,CAAC,OAAO;QACV,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;kCACb,8OAAC,sNAAQ;wBAAC,MAAM;;;;;;kCAChB,8OAAC;kCAAG;;;;;;kCACJ,8OAAC;kCAAE;;;;;;;;;;;;;;;;;IAIX;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC,sNAAQ;gCAAC,MAAM;;;;;;0CAChB,8OAAC;0CAAG;;;;;;0CACJ,8OAAC;gCAAK,WAAU;;kDACd,8OAAC,6NAAS;wCAAC,MAAM;wCAAI,WAAW,YAAY,aAAa;;;;;;oCAAM;;;;;;;;;;;;;kCAInE,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;4BAAK,WAAU;;gCAAc;gCAAQ,MAAM,KAAK,CAAC,GAAG;gCAAI;;;;;;;;;;;;kCAE3D,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;4BACC,WAAU;4BACV,SAAS;4BACT,UAAU,KAAK,MAAM,KAAK;4BAC1B,OAAM;sCAEN,cAAA,8OAAC,oNAAM;gCAAC,MAAM;;;;;;;;;;;;;;;;;;;;;;0BAKpB,8OAAC;gBAAI,WAAU;0BACZ,KAAK,MAAM,KAAK,kBACf,8OAAC;oBAAI,WAAU;;sCACb,8OAAC,sNAAQ;4BAAC,MAAM;4BAAI,WAAU;;;;;;sCAC9B,8OAAC;sCAAE;;;;;;sCACH,8OAAC;;gCAAK;gCAAsC,MAAM,KAAK,CAAC,GAAG;gCAAG;;;;;;;;;;;;yCAGhE,8OAAC;oBAAI,WAAU;;wBACZ,KAAK,GAAG,CAAC,CAAC;4BACT,MAAM,cAAc,IAAI,IAAI,IAAI;4BAChC,qBACE,8OAAC;gCAEC,WAAW,CAAC,aAAa,EAAE,aAAa;;kDAExC,8OAAC;wCAAI,WAAW,CAAC,YAAY,EAAE,aAAa;kDACzC,eAAe;;;;;;kDAGlB,8OAAC;wCAAI,WAAU;;0DACb,8OAAC;gDAAI,WAAU;;kEACb,8OAAC;wDAAK,WAAW,CAAC,YAAY,EAAE,aAAa;kEAC1C,gBAAgB;;;;;;kEAEnB,8OAAC;wDAAK,WAAU;kEACb,WAAW,IAAI,SAAS;;;;;;oDAE1B,IAAI,WAAW,KAAK,2BACnB,8OAAC;wDAAK,WAAW,CAAC,YAAY,EAAE,IAAI,WAAW,GAAG,YAAY,SAAS;kEACpE,IAAI,WAAW,GAAG,MAAM;;;;;;;;;;;;0DAI/B,8OAAC;gDAAI,WAAU;0DACZ,IAAI,IAAI;;;;;;;;;;;;;+BAtBR,IAAI,EAAE;;;;;wBA2BjB;sCACA,8OAAC;4BAAI,KAAK;;;;;;;;;;;;;;;;;0BAKhB,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;;wBAAM,KAAK,MAAM;wBAAC;wBAAS,KAAK,MAAM,KAAK,IAAI,MAAM;;;;;;;;;;;;;;;;;;AAI9D"}},
    {"offset": {"line": 1615, "column": 0}, "map": {"version":3,"sources":["file:///Users/morgannstuart/Desktop/HomeAssist-WEB/HomeAssist-Dashboard/src/components/Usage.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { getSupabase, isConfigured } from '@/lib/supabase'\nimport { BarChart3, RefreshCw, TrendingUp, MessageSquare, Zap, LineChart } from 'lucide-react'\n\ninterface SessionUsage {\n  id: string\n  started_at: string\n  total_input_tokens: number | null\n  total_output_tokens: number | null\n}\n\ninterface DailyUsage {\n  date: string\n  input_tokens: number\n  output_tokens: number\n  total_tokens: number\n  sessions: number\n}\n\ninterface IntervalUsage {\n  startTime: number\n  endTime: number\n  input_tokens: number\n  output_tokens: number\n  total_tokens: number\n  label: string\n}\n\ntype ChartType = 'bar' | 'line'\n\nexport function Usage() {\n  const [sessions, setSessions] = useState<SessionUsage[]>([])\n  const [dailyUsage, setDailyUsage] = useState<DailyUsage[]>([])\n  const [intervalUsage, setIntervalUsage] = useState<IntervalUsage[]>([])\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState<string | null>(null)\n  const [totalInput, setTotalInput] = useState(0)\n  const [totalOutput, setTotalOutput] = useState(0)\n  const [configured, setConfigured] = useState(false)\n  const [chartType, setChartType] = useState<ChartType>('bar')\n  const [tooltip, setTooltip] = useState<{ x: number, y: number, content: string } | null>(null)\n  const [hoveredPointIndex, setHoveredPointIndex] = useState<number | null>(null)\n\n  useEffect(() => {\n    const isReady = isConfigured()\n    setConfigured(isReady)\n    if (isReady) {\n      fetchUsage()\n    } else {\n      setLoading(false)\n    }\n  }, [])\n\n  const fetchUsage = async () => {\n    setLoading(true)\n    setError(null)\n\n    try {\n      const supabase = getSupabase()\n      const { data, error: fetchError } = await supabase\n        .from('conversation_sessions')\n        .select('id, started_at, total_input_tokens, total_output_tokens')\n        .order('started_at', { ascending: false })\n        .limit(500)\n\n      if (fetchError) throw fetchError\n\n      setSessions(data || [])\n\n      // Calculate totals\n      let inputSum = 0\n      let outputSum = 0\n      \n      // Group by day\n      const dailyMap = new Map<string, DailyUsage>()\n      \n      for (const session of data || []) {\n        const input = session.total_input_tokens || 0\n        const output = session.total_output_tokens || 0\n        inputSum += input\n        outputSum += output\n\n        const date = new Date(session.started_at).toLocaleDateString('en-CA') // YYYY-MM-DD format\n        \n        if (!dailyMap.has(date)) {\n          dailyMap.set(date, {\n            date,\n            input_tokens: 0,\n            output_tokens: 0,\n            total_tokens: 0,\n            sessions: 0\n          })\n        }\n        \n        const day = dailyMap.get(date)!\n        day.input_tokens += input\n        day.output_tokens += output\n        day.total_tokens += input + output\n        day.sessions += 1\n      }\n\n      setTotalInput(inputSum)\n      setTotalOutput(outputSum)\n\n      // Sort by date and get last 14 days\n      const sortedDaily = Array.from(dailyMap.values())\n        .sort((a, b) => a.date.localeCompare(b.date))\n        .slice(-14)\n      \n      setDailyUsage(sortedDaily)\n\n      // Generate 12 intervals for line chart\n      if (data && data.length > 0) {\n        const timestamps = data.map(s => new Date(s.started_at).getTime())\n        const minTime = Math.min(...timestamps)\n        const maxTime = Math.max(...timestamps)\n        const timeRange = maxTime - minTime || 1 // Avoid division by zero\n        const intervalSize = timeRange / 12\n        \n        const intervals: IntervalUsage[] = []\n        \n        for (let i = 0; i < 12; i++) {\n          const startTime = minTime + (i * intervalSize)\n          const endTime = minTime + ((i + 1) * intervalSize)\n          \n          // Sum tokens for sessions in this interval\n          let input = 0\n          let output = 0\n          \n          for (const session of data) {\n            const sessionTime = new Date(session.started_at).getTime()\n            if (sessionTime >= startTime && sessionTime < endTime) {\n              input += session.total_input_tokens || 0\n              output += session.total_output_tokens || 0\n            }\n          }\n          \n          // Format label based on time range\n          const startDate = new Date(startTime)\n          const endDate = new Date(endTime)\n          let label: string\n          \n          if (timeRange < 24 * 60 * 60 * 1000) {\n            // Less than a day - show hours\n            label = startDate.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' })\n          } else if (timeRange < 7 * 24 * 60 * 60 * 1000) {\n            // Less than a week - show day and time\n            label = startDate.toLocaleDateString('en-US', { weekday: 'short', hour: 'numeric' })\n          } else {\n            // More than a week - show date\n            label = startDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })\n          }\n          \n          intervals.push({\n            startTime,\n            endTime,\n            input_tokens: input,\n            output_tokens: output,\n            total_tokens: input + output,\n            label\n          })\n        }\n        \n        setIntervalUsage(intervals)\n      } else {\n        setIntervalUsage([])\n      }\n    } catch (err) {\n      console.error('Failed to fetch usage:', err)\n      setError(err instanceof Error ? err.message : 'Failed to fetch usage data')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const formatNumber = (num: number): string => {\n    if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M'\n    if (num >= 1000) return (num / 1000).toFixed(1) + 'K'\n    return num.toString()\n  }\n\n  const estimateCost = (input: number, output: number): string => {\n    // Rough estimate based on GPT-4 pricing ($0.03/1K input, $0.06/1K output)\n    const cost = (input / 1000) * 0.03 + (output / 1000) * 0.06\n    return cost.toFixed(2)\n  }\n\n  const getMaxTokens = (): number => {\n    if (dailyUsage.length === 0) return 1\n    return Math.max(...dailyUsage.map(d => d.total_tokens), 1)\n  }\n\n  const getMaxIntervalTokens = (): number => {\n    if (intervalUsage.length === 0) return 1\n    return Math.max(...intervalUsage.map(d => d.total_tokens), 1)\n  }\n\n  // Generate SVG path for line chart (viewBox is 100x50) using intervals\n  const generateIntervalLinePath = (data: IntervalUsage[], key: 'input_tokens' | 'output_tokens' | 'total_tokens'): string => {\n    if (data.length === 0) return ''\n    \n    const maxTokens = getMaxIntervalTokens()\n    const width = data.length > 1 ? 100 / (data.length - 1) : 0\n    \n    return data.map((d, i) => {\n      const x = data.length === 1 ? 50 : i * width\n      const y = 50 - (d[key] / maxTokens) * 45 // Scale to fit in 0-50 range with padding\n      return `${i === 0 ? 'M' : 'L'} ${x} ${y}`\n    }).join(' ')\n  }\n\n  // Generate data points as percentage positions for HTML overlay using intervals\n  const generateIntervalDataPoints = (data: IntervalUsage[], key: 'input_tokens' | 'output_tokens'): { xPercent: number, yPercent: number, value: number }[] => {\n    if (data.length === 0) return []\n    \n    const maxTokens = getMaxIntervalTokens()\n    \n    return data.map((d, i) => {\n      const xPercent = data.length === 1 ? 50 : (i / (data.length - 1)) * 100\n      const yPercent = 100 - ((d[key] / maxTokens) * 90) // 90% of height, with some padding\n      return { xPercent, yPercent, value: d[key] }\n    })\n  }\n\n\n  if (!configured) {\n    return (\n      <div className=\"usage-container\">\n        <div className=\"usage-empty\">\n          <BarChart3 size={48} />\n          <h2>Not Configured</h2>\n          <p>Add your Supabase credentials in Settings to view token usage.</p>\n        </div>\n      </div>\n    )\n  }\n\n  if (loading) {\n    return (\n      <div className=\"usage-container\">\n        <div className=\"usage-empty\">\n          <div className=\"spinner\" />\n          <p>Loading usage data...</p>\n        </div>\n      </div>\n    )\n  }\n\n  if (error) {\n    return (\n      <div className=\"usage-container\">\n        <div className=\"usage-empty\">\n          <div className=\"error-icon\">⚠️</div>\n          <h2>Error</h2>\n          <p>{error}</p>\n          <button className=\"retry-btn\" onClick={fetchUsage}>\n            <RefreshCw size={16} />\n            Retry\n          </button>\n        </div>\n      </div>\n    )\n  }\n\n  const maxTokens = getMaxTokens()\n  const totalTokens = totalInput + totalOutput\n  const inputDataPoints = generateIntervalDataPoints(intervalUsage, 'input_tokens')\n  const outputDataPoints = generateIntervalDataPoints(intervalUsage, 'output_tokens')\n\n  return (\n    <>\n    <div className=\"usage-container\">\n      <div className=\"usage-header\">\n        <div className=\"usage-title\">\n          <BarChart3 size={24} />\n          <h2>Token Usage</h2>\n        </div>\n        <button className=\"icon-btn\" onClick={fetchUsage} title=\"Refresh\">\n          <RefreshCw size={16} />\n        </button>\n      </div>\n\n      {/* Stats Cards */}\n      <div className=\"usage-stats\">\n        <div className=\"stat-card\">\n          <div className=\"stat-icon\">\n            <Zap size={20} />\n          </div>\n          <div className=\"stat-content\">\n            <span className=\"stat-value\">{formatNumber(totalTokens)}</span>\n            <span className=\"stat-label\">Total Tokens</span>\n          </div>\n        </div>\n        <div className=\"stat-card\">\n          <div className=\"stat-icon input\">\n            <TrendingUp size={20} />\n          </div>\n          <div className=\"stat-content\">\n            <span className=\"stat-value\">{formatNumber(totalInput)}</span>\n            <span className=\"stat-label\">Input Tokens</span>\n          </div>\n        </div>\n        <div className=\"stat-card\">\n          <div className=\"stat-icon output\">\n            <TrendingUp size={20} />\n          </div>\n          <div className=\"stat-content\">\n            <span className=\"stat-value\">{formatNumber(totalOutput)}</span>\n            <span className=\"stat-label\">Output Tokens</span>\n          </div>\n        </div>\n        <div className=\"stat-card\">\n          <div className=\"stat-icon cost\">\n            <MessageSquare size={20} />\n          </div>\n          <div className=\"stat-content\">\n            <span className=\"stat-value\">${estimateCost(totalInput, totalOutput)}</span>\n            <span className=\"stat-label\">Est. Cost (GPT-4)</span>\n          </div>\n        </div>\n      </div>\n\n      {/* Chart */}\n      <div className=\"usage-chart-container\">\n        <div className=\"chart-header\">\n          <h3>{chartType === 'bar' ? 'Daily Usage (Last 14 Days)' : 'Usage Over Time (12 Intervals)'}</h3>\n          <div className=\"chart-type-selector\">\n            <button \n              className={`chart-type-btn ${chartType === 'bar' ? 'active' : ''}`}\n              onClick={() => setChartType('bar')}\n              title=\"Bar Chart\"\n            >\n              <BarChart3 size={16} />\n            </button>\n            <button \n              className={`chart-type-btn ${chartType === 'line' ? 'active' : ''}`}\n              onClick={() => setChartType('line')}\n              title=\"Line Chart\"\n            >\n              <LineChart size={16} />\n            </button>\n          </div>\n        </div>\n\n        {dailyUsage.length === 0 ? (\n          <div className=\"chart-empty\">\n            <p>No usage data available</p>\n          </div>\n        ) : (\n          <div className=\"usage-chart\">\n            {chartType === 'bar' ? (\n              /* Bar Chart */\n              <div className=\"chart-bars\">\n                {dailyUsage.map((day) => (\n                  <div \n                    key={day.date} \n                    className=\"chart-bar-group\"\n                    onMouseEnter={(e) => {\n                      const rect = e.currentTarget.getBoundingClientRect()\n                      setTooltip({\n                        x: rect.left + rect.width / 2,\n                        y: rect.top - 10,\n                        content: `${new Date(day.date).toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' })}\\nInput: ${formatNumber(day.input_tokens)}\\nOutput: ${formatNumber(day.output_tokens)}\\nTotal: ${formatNumber(day.total_tokens)}`\n                      })\n                    }}\n                    onMouseLeave={() => setTooltip(null)}\n                  >\n                    <div className=\"chart-bar-wrapper\">\n                      <div \n                        className=\"chart-bar output\"\n                        style={{ height: `${(day.output_tokens / maxTokens) * 100}%` }}\n                      />\n                      <div \n                        className=\"chart-bar input\"\n                        style={{ height: `${(day.input_tokens / maxTokens) * 100}%` }}\n                      />\n                    </div>\n                    <span className=\"chart-label\">\n                      {new Date(day.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\n                    </span>\n                    <span className=\"chart-value\">{formatNumber(day.total_tokens)}</span>\n                  </div>\n                ))}\n              </div>\n            ) : (\n              /* Line Chart */\n              <div className=\"chart-line-container\">\n                <div className=\"chart-line-wrapper\">\n                  <svg \n                    className=\"chart-line-svg\" \n                    viewBox=\"0 0 100 50\" \n                    preserveAspectRatio=\"none\"\n                  >\n                    {/* Grid lines */}\n                    <line x1=\"0\" y1=\"12.5\" x2=\"100\" y2=\"12.5\" className=\"chart-grid-line\" />\n                    <line x1=\"0\" y1=\"25\" x2=\"100\" y2=\"25\" className=\"chart-grid-line\" />\n                    <line x1=\"0\" y1=\"37.5\" x2=\"100\" y2=\"37.5\" className=\"chart-grid-line\" />\n                    \n                    {/* Area fills */}\n                    <path \n                      d={`${generateIntervalLinePath(intervalUsage, 'output_tokens')} L 100 50 L 0 50 Z`}\n                      className=\"chart-area output\"\n                    />\n                    <path \n                      d={`${generateIntervalLinePath(intervalUsage, 'input_tokens')} L 100 50 L 0 50 Z`}\n                      className=\"chart-area input\"\n                    />\n                    \n                    {/* Lines */}\n                    <path \n                      d={generateIntervalLinePath(intervalUsage, 'output_tokens')}\n                      className=\"chart-line output\"\n                    />\n                    <path \n                      d={generateIntervalLinePath(intervalUsage, 'input_tokens')}\n                      className=\"chart-line input\"\n                    />\n                  </svg>\n                  \n                  {/* Data points as HTML elements to avoid stretching */}\n                  <div className=\"chart-points-overlay\">\n                    {intervalUsage.map((interval, i) => {\n                      const xPercent = intervalUsage.length === 1 ? 50 : (i / (intervalUsage.length - 1)) * 100\n                      return (\n                        <div\n                          key={`hover-${i}`}\n                          className=\"chart-point-hitarea\"\n                          style={{ left: `${xPercent}%` }}\n                          onMouseEnter={(e) => {\n                            setHoveredPointIndex(i)\n                            const rect = e.currentTarget.getBoundingClientRect()\n                            setTooltip({\n                              x: rect.left + rect.width / 2,\n                              y: rect.top - 10,\n                              content: `${interval.label}\\nInput: ${formatNumber(interval.input_tokens)}\\nOutput: ${formatNumber(interval.output_tokens)}\\nTotal: ${formatNumber(interval.total_tokens)}`\n                            })\n                          }}\n                          onMouseLeave={() => {\n                            setHoveredPointIndex(null)\n                            setTooltip(null)\n                          }}\n                        />\n                      )\n                    })}\n                    {outputDataPoints.map((point, i) => (\n                      <div\n                        key={`output-${i}`}\n                        className={`chart-point output ${hoveredPointIndex === i ? 'hovered' : ''}`}\n                        style={{ left: `${point.xPercent}%`, top: `${point.yPercent}%` }}\n                      />\n                    ))}\n                    {inputDataPoints.map((point, i) => (\n                      <div\n                        key={`input-${i}`}\n                        className={`chart-point input ${hoveredPointIndex === i ? 'hovered' : ''}`}\n                        style={{ left: `${point.xPercent}%`, top: `${point.yPercent}%` }}\n                      />\n                    ))}\n                  </div>\n                </div>\n                <div className=\"chart-line-labels\">\n                  {intervalUsage.filter((_, i) => i === 0 || i === 5 || i === 11).map((interval, i) => (\n                    <span \n                      key={interval.startTime} \n                      className=\"chart-line-label\"\n                    >\n                      {interval.label}\n                    </span>\n                  ))}\n                </div>\n              </div>\n            )}\n            \n            <div className=\"chart-legend\">\n              <div className=\"legend-item\">\n                <span className=\"legend-color input\" />\n                <span>Input Tokens</span>\n              </div>\n              <div className=\"legend-item\">\n                <span className=\"legend-color output\" />\n                <span>Output Tokens</span>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Recent Sessions Table */}\n      <div className=\"usage-table-container\">\n        <h3>Recent Sessions</h3>\n        <div className=\"usage-table-wrapper\">\n          <table className=\"usage-table\">\n            <thead>\n              <tr>\n                <th>Date</th>\n                <th>Input</th>\n                <th>Output</th>\n                <th>Total</th>\n                <th>Est. Cost</th>\n              </tr>\n            </thead>\n            <tbody>\n              {sessions.slice(0, 20).map((session) => {\n                const input = session.total_input_tokens || 0\n                const output = session.total_output_tokens || 0\n                return (\n                  <tr key={session.id}>\n                    <td>{new Date(session.started_at).toLocaleString()}</td>\n                    <td>{formatNumber(input)}</td>\n                    <td>{formatNumber(output)}</td>\n                    <td>{formatNumber(input + output)}</td>\n                    <td>${estimateCost(input, output)}</td>\n                  </tr>\n                )\n              })}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n\n    {/* Tooltip - rendered outside container */}\n    {tooltip && (\n      <div \n        className=\"chart-tooltip\"\n        style={{ \n          left: tooltip.x,\n          top: tooltip.y\n        }}\n      >\n        {tooltip.content.split('\\n').map((line, i) => (\n          <div key={i} className={i === 0 ? 'tooltip-title' : 'tooltip-line'}>\n            {line}\n          </div>\n        ))}\n      </div>\n    )}\n    </>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2750, "column": 0}, "map": {"version":3,"sources":["file:///Users/morgannstuart/Desktop/HomeAssist-WEB/HomeAssist-Dashboard/src/components/Settings.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { Save, Check, AlertCircle, ExternalLink, RefreshCw, Copy, Key } from 'lucide-react'\nimport { isConfigured, reinitializeSupabase } from '@/lib/supabase'\n\ninterface SettingsProps {\n  onConnectionChange?: () => void\n}\n\nexport function Settings({ onConnectionChange }: SettingsProps) {\n  const [url, setUrl] = useState('')\n  const [anonKey, setAnonKey] = useState('')\n  const [consoleToken, setConsoleToken] = useState('')\n  const [saved, setSaved] = useState(false)\n  const [connected, setConnected] = useState(false)\n  const [testing, setTesting] = useState(false)\n  const [testError, setTestError] = useState<string | null>(null)\n  const [copiedCredentials, setCopiedCredentials] = useState(false)\n  const [copiedToken, setCopiedToken] = useState(false)\n\n  useEffect(() => {\n    const savedUrl = localStorage.getItem('supabase_url') || ''\n    const savedKey = localStorage.getItem('supabase_anon_key') || ''\n    const savedToken = localStorage.getItem('console_token') || ''\n    setUrl(savedUrl)\n    setAnonKey(savedKey)\n    setConsoleToken(savedToken)\n    setConnected(isConfigured())\n  }, [])\n\n  const handleSave = async () => {\n    localStorage.setItem('supabase_url', url)\n    localStorage.setItem('supabase_anon_key', anonKey)\n    localStorage.setItem('console_token', consoleToken)\n    \n    reinitializeSupabase()\n    \n    setSaved(true)\n    setConnected(isConfigured())\n    setTimeout(() => setSaved(false), 2000)\n    \n    await testConnection()\n    onConnectionChange?.()\n  }\n\n  const testConnection = async () => {\n    setTesting(true)\n    setTestError(null)\n    \n    try {\n      const client = reinitializeSupabase()\n      \n      const { error } = await client\n        .from('conversation_sessions')\n        .select('id')\n        .limit(1)\n      \n      if (error) {\n        setTestError(error.message)\n        setConnected(false)\n      } else {\n        setConnected(true)\n        setTestError(null)\n      }\n    } catch (err) {\n      setTestError(err instanceof Error ? err.message : 'Connection failed')\n      setConnected(false)\n    } finally {\n      setTesting(false)\n    }\n  }\n\n  const generateToken = () => {\n    const newToken = crypto.randomUUID()\n    setConsoleToken(newToken)\n  }\n\n  const copyCredentialsExample = () => {\n    const example = `{\n  \"supabase_url\": \"${url}\",\n  \"supabase_key\": \"${anonKey}\",\n  \"console_token\": \"${consoleToken}\",\n  \"user_id\": \"my-chatbot\",\n  \"wake_word_model\": \"hey-assistant\"\n}`\n    navigator.clipboard.writeText(example)\n    setCopiedCredentials(true)\n    setTimeout(() => setCopiedCredentials(false), 2000)\n  }\n\n  const copyToken = () => {\n    navigator.clipboard.writeText(consoleToken)\n    setCopiedToken(true)\n    setTimeout(() => setCopiedToken(false), 2000)\n  }\n\n  return (\n    <div className=\"settings-page\">\n      <div className=\"settings-header\">\n        <h2>Settings</h2>\n        <p>Configure your database connection and console token</p>\n      </div>\n\n      <div className=\"settings-content\">\n        {/* Connection Status */}\n        <div className=\"settings-card\">\n          <div className=\"card-header\">\n            <h3>Connection Status</h3>\n            <button \n              className=\"icon-btn\" \n              onClick={testConnection}\n              disabled={testing || !url || !anonKey}\n              title=\"Test connection\"\n            >\n              <RefreshCw size={16} className={testing ? 'spinning' : ''} />\n            </button>\n          </div>\n          <div className=\"card-body\">\n            <div className={`status-indicator ${connected && !testError ? 'connected' : 'disconnected'}`}>\n              {connected && !testError ? (\n                <>\n                  <Check size={20} />\n                  <span>Connected to Supabase</span>\n                </>\n              ) : (\n                <>\n                  <AlertCircle size={20} />\n                  <span>\n                    {testError || 'Not connected - Enter your credentials below'}\n                  </span>\n                </>\n              )}\n            </div>\n          </div>\n        </div>\n\n        {/* Supabase Credentials */}\n        <div className=\"settings-card\">\n          <div className=\"card-header\">\n            <h3>Database Credentials</h3>\n            <a\n              href=\"https://supabase.com/dashboard\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"external-link\"\n            >\n              Open Supabase\n              <ExternalLink size={14} />\n            </a>\n          </div>\n          <div className=\"card-body\">\n            <p className=\"info-text\">\n              These credentials let you view conversation history from your database.\n            </p>\n            <div className=\"form-group\">\n              <label htmlFor=\"supabase-url\">Project URL</label>\n              <input\n                id=\"supabase-url\"\n                type=\"text\"\n                placeholder=\"https://your-project.supabase.co\"\n                value={url}\n                onChange={(e) => setUrl(e.target.value)}\n              />\n            </div>\n\n            <div className=\"form-group\">\n              <label htmlFor=\"anon-key\">Anon/Public Key</label>\n              <input\n                id=\"anon-key\"\n                type=\"password\"\n                placeholder=\"your-anon-key\"\n                value={anonKey}\n                onChange={(e) => setAnonKey(e.target.value)}\n              />\n            </div>\n          </div>\n        </div>\n\n        {/* Console Token */}\n        <div className=\"settings-card\">\n          <div className=\"card-header\">\n            <h3>Console Token</h3>\n            <Key size={18} />\n          </div>\n          <div className=\"card-body\">\n            <p className=\"info-text\">\n              This token filters which API events appear in the Realtime Events console. \n              Use the same token in your chatbot's API requests.\n            </p>\n            <div className=\"form-group\">\n              <label htmlFor=\"console-token\">Token</label>\n              <div className=\"token-input-row\">\n                <input\n                  id=\"console-token\"\n                  type=\"text\"\n                  placeholder=\"Enter or generate a token\"\n                  value={consoleToken}\n                  onChange={(e) => setConsoleToken(e.target.value)}\n                />\n                <button \n                  className=\"icon-btn\" \n                  onClick={copyToken} \n                  title=\"Copy token\"\n                  disabled={!consoleToken}\n                >\n                  {copiedToken ? <Check size={16} /> : <Copy size={16} />}\n                </button>\n              </div>\n            </div>\n            <button className=\"secondary-btn\" onClick={generateToken}>\n              Generate Random Token\n            </button>\n          </div>\n        </div>\n\n        {/* Save Button */}\n        <button \n          className=\"save-btn full-width\" \n          onClick={handleSave}\n          disabled={!url || !anonKey}\n        >\n          {testing ? (\n            <>\n              <RefreshCw size={16} className=\"spinning\" />\n              Testing...\n            </>\n          ) : saved ? (\n            <>\n              <Check size={16} />\n              Saved!\n            </>\n          ) : (\n            <>\n              <Save size={16} />\n              Save Settings\n            </>\n          )}\n        </button>\n\n        {/* API Usage */}\n        <div className=\"settings-card\">\n          <div className=\"card-header\">\n            <h3>API Usage</h3>\n            <button \n              className=\"icon-btn\"\n              onClick={copyCredentialsExample}\n              disabled={!url || !anonKey}\n              title=\"Copy example\"\n            >\n              {copiedCredentials ? <Check size={16} /> : <Copy size={16} />}\n            </button>\n          </div>\n          <div className=\"card-body\">\n            <p className=\"info-text\">\n              Include credentials and console token in API requests:\n            </p>\n            <pre className=\"code-block\">\n{`POST /api/sessions\n{\n  \"supabase_url\": \"${url || 'YOUR_URL'}\",\n  \"supabase_key\": \"${anonKey ? '***' : 'YOUR_KEY'}\",\n  \"console_token\": \"${consoleToken || 'YOUR_TOKEN'}\",\n  \"user_id\": \"my-chatbot\"\n}`}\n            </pre>\n            <ul className=\"endpoint-list\">\n              <li><code>POST /api/sessions</code> - Create a session</li>\n              <li><code>POST /api/messages</code> - Add a message</li>\n              <li><code>POST /api/tool-calls</code> - Record a tool call</li>\n              <li><code>POST /api/sessions/[id]/end</code> - End a session</li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3410, "column": 0}, "map": {"version":3,"sources":["file:///Users/morgannstuart/Desktop/HomeAssist-WEB/HomeAssist-Dashboard/src/app/page.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect, useCallback } from 'react'\nimport { Sidebar } from '@/components/Sidebar'\nimport { ConversationViewer } from '@/components/ConversationViewer'\nimport { Console } from '@/components/Console'\nimport { Usage } from '@/components/Usage'\nimport { Settings } from '@/components/Settings'\nimport { isConfigured } from '@/lib/supabase'\n\nexport default function Home() {\n  const [activeView, setActiveView] = useState('console')\n  const [configured, setConfigured] = useState(false)\n  const [key, setKey] = useState(0)\n\n  const checkConfiguration = useCallback(() => {\n    setConfigured(isConfigured())\n  }, [])\n\n  useEffect(() => {\n    checkConfiguration()\n  }, [checkConfiguration])\n\n  const handleConnectionChange = () => {\n    checkConfiguration()\n    setKey(prev => prev + 1)\n  }\n\n  const renderContent = () => {\n    switch (activeView) {\n      case 'conversations':\n        return <ConversationViewer key={key} />\n      case 'console':\n        return <Console key={key} />\n      case 'usage':\n        return <Usage key={key} />\n      case 'settings':\n        return <Settings onConnectionChange={handleConnectionChange} />\n      default:\n        return <Console key={key} />\n    }\n  }\n\n  return (\n    <div className=\"app\">\n      <Sidebar\n        activeView={activeView}\n        onViewChange={setActiveView}\n        isConfigured={configured}\n      />\n      <main className=\"main-content\">\n        {renderContent()}\n      </main>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;;;;;;;;;AAUe,SAAS;IACtB,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;IAC7C,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;IAC7C,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,iNAAQ,EAAC;IAE/B,MAAM,qBAAqB,IAAA,oNAAW,EAAC;QACrC,cAAc,IAAA,sIAAY;IAC5B,GAAG,EAAE;IAEL,IAAA,kNAAS,EAAC;QACR;IACF,GAAG;QAAC;KAAmB;IAEvB,MAAM,yBAAyB;QAC7B;QACA,OAAO,CAAA,OAAQ,OAAO;IACxB;IAEA,MAAM,gBAAgB;QACpB,OAAQ;YACN,KAAK;gBACH,qBAAO,8OAAC,8JAAkB,MAAM;;;;;YAClC,KAAK;gBACH,qBAAO,8OAAC,wIAAO,MAAM;;;;;YACvB,KAAK;gBACH,qBAAO,8OAAC,oIAAK,MAAM;;;;;YACrB,KAAK;gBACH,qBAAO,8OAAC,0IAAQ;oBAAC,oBAAoB;;;;;;YACvC;gBACE,qBAAO,8OAAC,wIAAO,MAAM;;;;;QACzB;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC,wIAAO;gBACN,YAAY;gBACZ,cAAc;gBACd,cAAc;;;;;;0BAEhB,8OAAC;gBAAK,WAAU;0BACb;;;;;;;;;;;;AAIT"}}]
}